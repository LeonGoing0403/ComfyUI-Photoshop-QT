import{api}from'../../scripts/api.js';import{getSysInfo}from'./e07b2690.js';globalThis['leonPS']=globalThis['leonPS']||{};export const leonPS=globalThis['leonPS'];let app;try{app=window[_0x2565dc(-0x3e2,-0x3e8)];}catch(_0x4acb88){console['error']('Failed\x20to\x20access\x20app\x20from\x20window',_0x4acb88),app={'workflowManager':null,'extensionManager':{'workflow':null}};}const customNodeConvertersByWildcard=[];function _0x2565dc(_0x57afac,_0x51e67b){return _0x38d6(_0x51e67b- -0x3e8,_0x57afac);}leonPS['widgetable']=leonPS['widgetable']||{},leonPS['widgetable']['add']=function(_0x36aac0,_0xb8adec){function _0x390ba1(_0x4792aa,_0x5e8495){return _0x38d6(_0x4792aa- -0x351,_0x5e8495);}typeof _0xb8adec==='function'?customNodeConvertersByWildcard['push']([_0x36aac0,{'formatter':_0xb8adec,'setter':null}]):customNodeConvertersByWildcard[_0x390ba1(-0x350,-0x35a)]([_0x36aac0,_0xb8adec]);};export function setNodeValue(_0x35c3e4,_0x326180){if(!_0x35c3e4||!_0x35c3e4['nodes']||!_0x326180){console['error']('无效的graph或nodeArray');return;}function _0x5728e6(_0x27bc42,_0x3fabbc){return _0x38d6(_0x3fabbc- -0x369,_0x27bc42);}_0x326180['forEach'](_0x1a0da7=>{const _0xa0bce3=_0x35c3e4[_0x10d250(0xad,0xb0)]['find'](_0x4aaedd=>_0x4aaedd['id']===_0x1a0da7['id']);function _0x10d250(_0x325906,_0x282dfe){return _0x38d6(_0x325906-0xab,_0x282dfe);}_0xa0bce3?_0x1a0da7['widgets']['forEach']((_0x58d757,_0x5dac31)=>{function _0x1de19e(_0x3a7f71,_0x2bf339){return _0x38d6(_0x3a7f71-0x277,_0x2bf339);}_0xa0bce3[_0x1de19e(0x27a,0x27e)]&&_0x5dac31<_0xa0bce3['widgets']['length']&&(_0xa0bce3[_0x1de19e(0x27b,0x271)]=_0x1a0da7['nodeType']||_0xa0bce3['type'],_0xa0bce3['type']['includes'](_0x1de19e(0x27c,0x28a))?setRgthreeWidgetValue(_0xa0bce3,_0x5dac31,_0x58d757[_0x1de19e(0x27d,0x286)]):setWidgetValue(_0xa0bce3,_0x5dac31,_0x58d757['value']));}):console[_0x10d250(0xb2,0xa8)](_0x10d250(0xb3,0xa4)+_0x1a0da7['id']+_0x10d250(0xb4,0xb8));}),_0x35c3e4[_0x5728e6(-0x36a,-0x35f)]&&_0x35c3e4['setDirtyCanvas'](!![]);}export async function setRgthreeWidgetValue(_0x12a8d7,_0x2deea4,_0x58ed67){console['log'](_0xc31652(0x69,0x5e),_0x12a8d7,_0x2deea4,_0x58ed67);const _0x54544c=await getSysInfo();function _0xc31652(_0x33c39a,_0x4199f2){return _0x38d6(_0x33c39a-0x5e,_0x4199f2);}_0x54544c['system'][_0xc31652(0x6a,0x64)]===_0xc31652(0x6b,0x64)?(console[_0xc31652(0x6c,0x76)]('comfyui_version:',_0x54544c['system']['comfyui_version']),_0x12a8d7['widgets'][_0x2deea4][_0xc31652(0x64,0x74)]==!_0x58ed67&&(console['log']('setRgthreeWidgetValue222222,node:',_0x12a8d7,_0x2deea4,_0x58ed67),_0x12a8d7[_0xc31652(0x61,0x57)][_0x2deea4]['doModeChange'](),api['dispatchEvent'](new Event('graphChanged',{'bubbles':!![]})))):(console['log'](_0xc31652(0x6d,0x65),_0x54544c[_0xc31652(0x6e,0x66)][_0xc31652(0x6a,0x6e)]),typeof _0x12a8d7['type']==='string'&&_0x12a8d7['type']['includes'](_0xc31652(0x6f,0x5f))?_0x12a8d7['widgets'][_0x2deea4]['value'][_0xc31652(0x70,0x6b)]==!_0x58ed67&&(console['log']('setRgthreeWidgetValue222222,node:',_0x12a8d7,_0x2deea4,_0x58ed67),_0x12a8d7['widgets'][_0x2deea4][_0xc31652(0x71,0x78)](),api['dispatchEvent'](new Event('graphChanged',{'bubbles':!![]}))):_0x12a8d7[_0xc31652(0x61,0x56)][_0x2deea4][_0xc31652(0x64,0x62)]==!_0x58ed67&&(console['log']('setRgthreeWidgetValue222222,node:',_0x12a8d7,_0x2deea4,_0x58ed67),_0x12a8d7[_0xc31652(0x61,0x5f)][_0x2deea4]['doModeChange'](),api['dispatchEvent'](new Event('graphChanged',{'bubbles':!![]}))));}export function setWidgetValue(_0x1fbab4,_0x60303d,_0x36e6aa){const _0x557b44=customNodeConvertersByWildcard['find'](([_0x48e254])=>{function _0x22d60b(_0x364936,_0x4c5676){return _0x38d6(_0x364936- -0x1ac,_0x4c5676);}return wildcardMatch(_0x48e254,_0x1fbab4[_0x22d60b(-0x1a8,-0x19f)]);});function _0xb5328e(_0x836ae4,_0x44d403){return _0x38d6(_0x44d403-0x57,_0x836ae4);}let _0x42c64c=![];if(_0x557b44){const _0x45c879=_0x557b44[0x1][_0xb5328e(0x6e,0x6b)];_0x45c879&&(_0x42c64c=!!_0x45c879(_0x1fbab4,_0x60303d,_0x36e6aa));}!_0x42c64c&&(_0x1fbab4['widgets'][_0x60303d]['value']=_0x36e6aa,_0x1fbab4[_0xb5328e(0x63,0x5a)][_0x60303d]['callback']?.(_0x36e6aa));}export function findAvailableNodeInGraph(_0x78a5d6){return _0x78a5d6?.['nodes']['map'](_0xfb2329=>{if(_0xfb2329['mode']!=0x0)return;if(!_0xfb2329['title'])return;const _0x12b148=getTitle(_0xfb2329);function _0x342b90(_0x532cee,_0x9ac5c0){return _0x38d6(_0x532cee- -0x17c,_0x9ac5c0);}if(!_0x12b148||_0x12b148['startsWith']('!'))return;if(!_0xfb2329['widgets']||_0xfb2329['widgets']['length']==0x0){if(_0xfb2329[_0x342b90(-0x178,-0x176)]!=_0x342b90(-0x167,-0x15f))return;}const _0x294c32=customNodeConvertersByWildcard['find'](([_0xd5b21c])=>{return wildcardMatch(_0xd5b21c,_0xfb2329['type']);});if(_0x294c32)try{const _0x323d05=_0x294c32[0x1]['formatter'](_0xfb2329);if(_0x323d05)return _0x323d05['id']=_0xfb2329['id'],_0x323d05['nodeType']=_0xfb2329['type'],_0x323d05;}catch(_0x2c2d81){return{'id':_0xfb2329['id'],'title':_0x12b148,'nodeType':_0xfb2329[_0x342b90(-0x178,-0x179)],'widgets':[{'outputType':'error','value':_0x342b90(-0x166,-0x175)+_0x294c32[0x0]+_0x342b90(-0x165,-0x15e)+(_0x2c2d81['message']||_0x2c2d81||'')+(_0x2c2d81?.[_0x342b90(-0x164,-0x161)]||'')}]};}if(!_0x12b148['startsWith']('#'))return console['log'](_0x342b90(-0x163,-0x171),_0x12b148),null;let _0x3fa7de=_0xfb2329['widgets'];return{'id':_0xfb2329['id'],'title':_0x12b148,'nodeType':_0xfb2329[_0x342b90(-0x178,-0x188)],'widgets':_0x3fa7de['map'](_0xb4afd5=>({'value':_0xb4afd5[_0x342b90(-0x176,-0x17e)],'name':_0xb4afd5['label']||_0xb4afd5['name'],'outputType':_0xb4afd5['type']||'string','options':_0xb4afd5[_0x342b90(-0x162,-0x160)]}))};})['filter'](Boolean)['sort']((_0x12c251,_0x5bcb03)=>{let _0xf42703=getTitle(_0x12c251),_0x8a4516=getTitle(_0x5bcb03);_0xf42703=_0xf42703['startsWith']('#')?_0xf42703['slice'](0x1)[_0x4c31c8(-0x3c1,-0x3c6)]():_0xf42703[_0x4c31c8(-0x3b6,-0x3c6)]();function _0x4c31c8(_0x40a468,_0x5db8c9){return _0x38d6(_0x5db8c9- -0x3e1,_0x40a468);}return _0x8a4516=_0x8a4516['startsWith']('#')?_0x8a4516[_0x4c31c8(-0x3c7,-0x3c5)](0x1)['trim']():_0x8a4516['trim'](),_0xf42703[_0x4c31c8(-0x3c5,-0x3c4)](_0x8a4516);});}function _0x1fd1(){const _0x318ab7=['app','push','nodes','widgets','type','rgthree','value','error','未找到ID为','的实际节点','setDirtyCanvas','setRgthreeWidgetValue333333,node:','comfyui_version','0.3.27','log','comfyui_version:','system','Groups','toggled','doModeChange','setter','PreviewImage','convert\x20widget\x20','\x20failed:','stack','!title.startsWith(\x27#\x27)','options','trim','slice','localeCompare','replace','setProperty','startsWith','getNodeTitle'];_0x1fd1=function(){return _0x318ab7;};return _0x1fd1();}function _0x38d6(_0x1fd17d,_0x38d698){const _0x200cdb=_0x1fd1();return _0x38d6=function(_0xf4e2ca,_0x33ee6e){_0xf4e2ca=_0xf4e2ca-0x0;let _0x43d9f6=_0x200cdb[_0xf4e2ca];return _0x43d9f6;},_0x38d6(_0x1fd17d,_0x38d698);}function wildcardMatch(_0x156db1,_0x5396a9){const _0x40b777=_0x156db1['replace'](/[.+^${}()|[\]\\]/g,'\x5c$&')[_0x51ad05(0x2a6,0x2a2)](/\*/g,'.*')['replace'](/\?/g,'.');function _0x51ad05(_0x293235,_0x1b28d3){return _0x38d6(_0x1b28d3-0x284,_0x293235);}const _0x29e3e6=new RegExp('^'+_0x40b777+'$');return _0x29e3e6['test'](_0x5396a9);}function getTitle(_0x5418f9,_0x3c4492=''){let _0x25c1a3=_0x3c4492||_0x5418f9['title'];_0x5418f9[_0x450c3e(0x213,0x220)]&&(_0x25c1a3['startsWith']('#')||_0x25c1a3[_0x450c3e(0x210,0x221)]('.'))?_0x5418f9[_0x450c3e(0x227,0x220)]('leon_widgetable_title',_0x25c1a3):_0x25c1a3=_0x5418f9['properties']?.['leon_widgetable_title']||_0x25c1a3;function _0x450c3e(_0x4b18ee,_0x433587){return _0x38d6(_0x433587-0x201,_0x4b18ee);}return _0x25c1a3;}leonPS[_0x2565dc(-0x3c0,-0x3c7)]=getTitle;